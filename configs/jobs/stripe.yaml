# configs/jobs/stripe.yaml

tenant_id: acme
environment: prod

source:
  type: stripe
  description: "Stripe customers"
  credentials:
    from_env: STRIPE_API_KEY
    scope: tenant
  objects: [customers]
  incremental:
    strategy: created                 # REQUIRED when incremental used; matches registry default
    cursor_field: created
    lookback_days: 1
    state_path: /state/acme/stripe.customers.state.json
  rate_limits:
    rps: 7
    burst: 14
    retry:
      max_retries: 5
      backoff: exponential
      max_backoff_seconds: 64

target:
  type: iceberg
  catalog: nessie
  branch: acme
  warehouse: s3://lake/acme/
  file_format: parquet
  partitioning: [ingest_date]

asset_definition: /app/specs/stripe/v1.0/customers.yaml

logging:
  redaction: true
  level: INFO

