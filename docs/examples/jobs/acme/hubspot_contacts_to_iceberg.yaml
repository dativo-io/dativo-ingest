# HubSpot contacts to Iceberg job for tenant acme
tenant_id: acme
environment: prod

source_connector: hubspot
source_connector_path: /app/connectors/hubspot.yaml

target_connector: iceberg
target_connector_path: /app/connectors/iceberg.yaml

asset: hubspot_contacts
asset_path: /app/assets/hubspot/v1.0/contacts.yaml

source:
  objects: [contacts]
  incremental:
    lookback_days: 1

target:
  branch: acme
  warehouse: s3://lake/acme/
  connection:
    nessie:
      uri: "http://nessie.acme.internal:19120/api/v1"
    s3:
      bucket: "acme-data-lake"
      prefix: "raw/hubspot/contacts"

data_catalogs:
  - name: openmetadata_primary
    type: openmetadata
    service_name: "acme_lakehouse"
    database_service: "iceberg"
    database_name: "acme"
    schema_name: "crm"
    scope:
      assets: [hubspot_contacts]
    connection:
      server_url: "${OPENMETADATA_SERVER_URL}"
      auth_provider: jwt
      auth:
        token: "${OPENMETADATA_TOKEN}"
  - name: glue_lakehouse
    type: aws_glue
    connection:
      region: "us-west-2"
      catalog_id: "${AWS_ACCOUNT_ID}"
      database: "acme_lakehouse"
      table_prefix: "hubspot_contacts"

logging:
  redaction: true
  level: INFO

