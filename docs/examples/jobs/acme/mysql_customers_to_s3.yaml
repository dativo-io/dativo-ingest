# MySQL customers to S3 job for tenant acme
tenant_id: acme
environment: prod

source_connector: mysql
source_connector_path: /app/connectors/mysql.yaml

target_connector: s3
target_connector_path: /app/connectors/s3.yaml

asset: mysql_customers
asset_path: /app/assets/mysql/v1.0/db_customers.yaml

source:
  tables:
    - name: public.customers
      object: db_customers
      cursor_field: updated_at
  incremental:
    lookback_days: 1
  connection:
    host: "${MYSQL_HOST}"
    port: "${MYSQL_PORT}"
    database: "${MYSQL_DB}"

target:
  connection:
    bucket: "acme-data-lake"
    prefix: "raw/mysql/customers"

logging:
  redaction: true
  level: INFO

# Infrastructure runtime (externally managed via Terraform)
infrastructure:
  provider: aws
  region: eu-west-1
  runtime:
    type: aws_fargate
  resource_identifiers:
    cluster_name: "{{terraform_outputs.cluster_name}}"
    service_name: "{{terraform_outputs.service_name}}"
    execution_role_arn: "{{terraform_outputs.execution_role_arn}}"
  tags:
    job_name: mysql_customers_to_s3
    team: core_data
    pipeline_type: ingestion
    environment: prod
    cost_center: FINOPS-ACME

