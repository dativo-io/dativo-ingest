asset:
  name: csv_listening_history
  source_type: csv
  object: listening_history
  version: "1.0"

  schema:
    - name: user_id
      type: string
      required: true
    - name: track_id
      type: string
      required: true
    - name: artist_name
      type: string
      required: true
    - name: track_name
      type: string
      required: true
    - name: album_name
      type: string
      required: false
    - name: playlist_name
      type: string
      required: false
    - name: playlist_id
      type: string
      required: false
    - name: playlist_genre
      type: string
      required: false
    - name: playlist_subgenre
      type: string
      required: false
    - name: playlist_track_id
      type: integer
      required: false
    - name: duration_ms
      type: integer
      required: true
    - name: played_at
      type: timestamp
      required: true
    - name: skip_1
      type: integer
      required: false
    - name: skip_2
      type: integer
      required: false
    - name: skip_3
      type: integer
      required: false
    - name: context_type
      type: string
      required: false
    - name: hist_user_behavior_reason_start
      type: string
      required: false
    - name: hist_user_behavior_reason_end
      type: string
      required: false
    - name: hist_user_behavior_n_seekfwd
      type: integer
      required: false
    - name: hist_user_behavior_n_seekback
      type: integer
      required: false
    - name: hist_user_behavior_n_pause
      type: integer
      required: false
    - name: hist_user_behavior_is_shuffle
      type: boolean
      required: false
    - name: date
      type: date
      required: true
    - name: premium_user
      type: boolean
      required: false

  governance:
    owner: data-team@company.com
    cost_center: FIN-OPS-002
    tags: [music, listening, streaming, test-data]
    classification: [NON_SENSITIVE]
    retention_days: 90

  lineage:
    - from_asset: source.streaming.platform_listens
      to_asset: csv_listening_history
      contract_version: "1.0"
      description: Daily ingestion of listening telemetry from source platform

  audit:
    - author: data-team@company.com
      change_type: initial_publish
      timestamp: 2025-01-12T12:00:00Z
      hash: 6f1a2f4b9d4c3e721aa9d2f18495d1c3ee1f6f8d9a0b2c3d4e5f6a7b8c9d0e1f

  target:
    file_format: parquet
    partitioning: [ingest_date]
    mode: strict
