# HubSpot contacts to Iceberg with Databricks Unity Catalog integration
tenant_id: acme
environment: prod

# Source connector - HubSpot with Airbyte engine
source_connector: hubspot
source_connector_path: /app/connectors/hubspot.yaml

# Target connector - Iceberg
target_connector: iceberg
target_connector_path: /app/connectors/iceberg.yaml

# Asset definition
asset: hubspot_contacts
asset_path: /app/assets/hubspot/v1.0/contacts.yaml

# Data catalog configuration - Databricks Unity Catalog
catalog:
  type: databricks_unity
  enabled: true
  connection:
    workspace_url: ${DATABRICKS_WORKSPACE_URL}
    token: ${DATABRICKS_TOKEN}
    catalog: main
    schema: hubspot
    bucket: acme-unity-catalog

# Source configuration
source:
  objects: [contacts]
  incremental:
    strategy: updated
    cursor_field: hs_lastmodifieddate
    lookback_days: 1

# Target configuration - Iceberg
target:
  catalog: nessie
  branch: acme
  warehouse: s3://acme-unity-catalog/
  connection:
    nessie:
      uri: ${NESSIE_URI}
    s3:
      bucket: acme-unity-catalog
      prefix: raw/hubspot/contacts
      access_key_id: ${AWS_ACCESS_KEY_ID}
      secret_access_key: ${AWS_SECRET_ACCESS_KEY}
      region: ${AWS_REGION}

# Governance overrides
classification_overrides:
  email: PII
  phone: PII
  mobilephone: PII
  
finops:
  cost_center: marketing
  business_tags: [hubspot, contacts, crm]
  project: marketing-analytics

# Execution configuration
schema_validation_mode: warn

# Logging configuration
logging:
  redaction: true
  level: INFO
